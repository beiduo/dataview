<!doctype html>
<html lang="zh">
<head>
    <meta charset="UTF-8">
    <title>data demo</title>
    <script type="text/javascript" src="http://lib.sinaapp.com/js/jquery/1.9.1/jquery-1.9.1.min.js"></script>
    <script type="text/javascript" src="script/jquery.dataview.js"></script>
</head>
<body>
<div id="container"></div>
</body>
<script type="text/javascript">
//<![CDATA[

$.ajax({
    url: 'data/data.json',
    dataType: 'json',
    cache: false,
    success: function(data){
        var dataTable = $('#container').dataView(data, {
            items: {
                delete: function(){
                    var self = this;
                    self.node.parentNode.removeChild(self.node);
                    return false;
                },
                event: function(){
                    var self = this;

                    $(self.node).delegate('a', 'click', function(){
                        if ($(this).is('.delete')){

                            self.delete();
                        } else if ($(this).is('.edit')){
                            self.mode = '1';
                            self.mode = '1';
                            self.render();
                        } else if ($(this).is('.cancel')){
                            self.mode = '0';
                            self.mode = '0';
                            self.render();
                        } else if ($(this).is('.save')){
                            $.ajax({
                                url: 'data/edit.json',
                                dataType: 'json',
                                cache: false,
                                success: function(data){
                                    if (data.status === 'success'){
                                        var cb = data.data, field, i;
                                        for (var key in cb){
                                            field = self;
                                            field[key] = cb[key];
                                        }
                                        self.mode = '0';
                                        self.mode = '0';
                                        self.render();
                                    }
                                }
                            });
                        }
                    });
                }
            }
        });

        try { console.log(dataTable); } catch (e){}
    }
})


//]]>
</script>
</html>